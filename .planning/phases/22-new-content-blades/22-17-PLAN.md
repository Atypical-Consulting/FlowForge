---
phase: 22-new-content-blades
plan: 17
type: execute
wave: 1
depends_on: []
files_modified:
  - src/lib/branchClassifier.ts
  - src/components/gitflow/GitflowDiagram.tsx
  - src/index.css
  - src/components/blades/Viewer3dBlade.tsx
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Gitflow cheatsheet SVG diagram renders colored branch lanes (not a black rectangle)"
    - "Gitflow cheatsheet SVG shows 5 branch lanes with correct Catppuccin colors"
    - "React Flow controls render with visible theme-matched backgrounds and borders"
    - "3D model viewer background gradient renders with visible Catppuccin colors"
  artifacts:
    - path: "src/lib/branchClassifier.ts"
      provides: "Correct CSS variable references for branch type colors"
      contains: "var(--catppuccin-color-"
    - path: "src/components/gitflow/GitflowDiagram.tsx"
      provides: "SVG background rect with correct mantle variable"
      contains: "var(--catppuccin-color-mantle)"
    - path: "src/index.css"
      provides: "React Flow control styles with correct Catppuccin variables"
      contains: "var(--catppuccin-color-"
    - path: "src/components/blades/Viewer3dBlade.tsx"
      provides: "3D viewer background with correct Catppuccin variables"
      contains: "var(--catppuccin-color-"
  key_links:
    - from: "src/lib/branchClassifier.ts"
      to: "src/components/gitflow/GitflowDiagram.tsx"
      via: "BRANCH_TYPE_COLORS import used as SVG fill/stroke"
      pattern: "BRANCH_TYPE_COLORS\\["
---

<objective>
Fix CSS custom property name mismatch across all files that use var(--ctp-*) in inline styles, SVG attributes, and raw CSS.

Purpose: The code uses var(--ctp-red), var(--ctp-mantle), etc. but these CSS variables do not exist. The @catppuccin/tailwindcss plugin defines variables as --catppuccin-color-red, --catppuccin-color-mantle, etc. Tailwind utility classes (bg-ctp-red) work because they compile to var(--catppuccin-color-red), but direct var(--ctp-*) references in inline styles resolve to initial/unset values (black fill, invisible strokes), producing the "big dark rectangle" the user reported.

Output: All var(--ctp-*) references replaced with var(--catppuccin-color-*) across 4 files.
</objective>

<execution_context>
@/Users/phmatray/.claude/get-shit-done/workflows/execute-plan.md
@/Users/phmatray/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/22-new-content-blades/22-retest-UAT.md
@.planning/debug/gitflow-svg-dark-rectangle.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Replace var(--ctp-*) with var(--catppuccin-color-*) in all source files</name>
  <files>
    src/lib/branchClassifier.ts
    src/components/gitflow/GitflowDiagram.tsx
    src/index.css
    src/components/blades/Viewer3dBlade.tsx
  </files>
  <action>
    Replace every occurrence of `var(--ctp-X)` with `var(--catppuccin-color-X)` in these 4 files:

    **src/lib/branchClassifier.ts** (BRANCH_TYPE_COLORS object):
    - `var(--ctp-red)` -> `var(--catppuccin-color-red)`
    - `var(--ctp-blue)` -> `var(--catppuccin-color-blue)`
    - `var(--ctp-green)` -> `var(--catppuccin-color-green)`
    - `var(--ctp-peach)` -> `var(--catppuccin-color-peach)`
    - `var(--ctp-mauve)` -> `var(--catppuccin-color-mauve)`
    - `var(--ctp-overlay1)` -> `var(--catppuccin-color-overlay1)`

    **src/components/gitflow/GitflowDiagram.tsx** (SVG background rect):
    - Line 47: `var(--ctp-mantle)` -> `var(--catppuccin-color-mantle)`

    **src/index.css** (React Flow controls + keyframes):
    - All `var(--ctp-mantle)` -> `var(--catppuccin-color-mantle)`
    - All `var(--ctp-surface0)` -> `var(--catppuccin-color-surface0)`
    - All `var(--ctp-subtext0)` -> `var(--catppuccin-color-subtext0)`
    - All `var(--ctp-text)` -> `var(--catppuccin-color-text)`
    - All `var(--ctp-overlay0)` -> `var(--catppuccin-color-overlay0)`
    - All `var(--ctp-yellow)` -> `var(--catppuccin-color-yellow)`

    **src/components/blades/Viewer3dBlade.tsx** (model-viewer background gradient, line 291):
    - `var(--ctp-base)` -> `var(--catppuccin-color-base)`
    - `var(--ctp-mantle)` -> `var(--catppuccin-color-mantle)`

    Do NOT change Tailwind utility classes (bg-ctp-red, text-ctp-overlay0, etc.) -- those compile correctly through Tailwind's theme system.
  </action>
  <verify>
    Run `grep -rn "var(--ctp-" src/` and confirm ZERO results. All inline CSS variable references should now use `var(--catppuccin-color-*)`.
    Run `npx tsc --noEmit` to confirm no TypeScript errors introduced.
  </verify>
  <done>
    Zero occurrences of var(--ctp-*) remain in src/. All inline style and raw CSS references use var(--catppuccin-color-*). The Gitflow SVG diagram renders colored lanes instead of a black rectangle. React Flow controls render with visible backgrounds.
  </done>
</task>

</tasks>

<verification>
- `grep -rn "var(--ctp-" src/` returns no matches
- `npx tsc --noEmit` passes (ignoring pre-existing TS2440 in bindings.ts)
- Gitflow cheatsheet blade shows colored branch lanes (not black rectangle)
- React Flow topology controls have visible themed backgrounds
</verification>

<success_criteria>
All var(--ctp-*) CSS variable references replaced with var(--catppuccin-color-*) across 4 files. TypeScript compiles clean.
</success_criteria>

<output>
After completion, create `.planning/phases/22-new-content-blades/22-17-SUMMARY.md`
</output>
