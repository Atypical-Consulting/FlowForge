---
phase: 14-ui-polish
plan: 02
type: execute
wave: 2
depends_on: ["14-01"]
files_modified:
  - src/components/staging/StagingPanel.tsx
  - src/components/stash/StashList.tsx
  - src/components/tags/TagList.tsx
  - src/components/commit/CommitHistory.tsx
  - src/components/RepositoryView.tsx
autonomous: true

must_haves:
  truths:
    - "Empty changes panel shows line art illustration and friendly guidance text"
    - "Empty stashes panel shows illustration and friendly guidance text"
    - "Empty tags panel shows illustration, friendly text, and a Create Tag CTA button"
    - "Empty commit history shows illustration and friendly text for new repos"
    - "All 5 sidebar panel headers have frosted glass effect with backdrop blur"
    - "StagingPanel and CommitHistory use skeleton loaders during initial data fetch"
  artifacts:
    - path: "src/components/staging/StagingPanel.tsx"
      provides: "Empty state for no changes + skeleton loader"
      contains: "EmptyState"
    - path: "src/components/stash/StashList.tsx"
      provides: "Empty state for no stashes"
      contains: "EmptyState"
    - path: "src/components/tags/TagList.tsx"
      provides: "Empty state with Create Tag CTA"
      contains: "EmptyState"
    - path: "src/components/commit/CommitHistory.tsx"
      provides: "Empty state for no commits + skeleton loader"
      contains: "EmptyState"
    - path: "src/components/RepositoryView.tsx"
      provides: "Frosted glass summary headers"
      contains: "backdrop-blur"
  key_links:
    - from: "src/components/staging/StagingPanel.tsx"
      to: "src/components/ui/EmptyState.tsx"
      via: "EmptyState import"
      pattern: "import.*EmptyState"
    - from: "src/components/tags/TagList.tsx"
      to: "src/components/ui/EmptyState.tsx"
      via: "EmptyState with CTA action prop"
      pattern: "action=.*onClick"
    - from: "src/components/staging/StagingPanel.tsx"
      to: "src/components/ui/Skeleton.tsx"
      via: "Skeleton import for loading state"
      pattern: "import.*Skeleton"
---

<objective>
Wire empty state illustrations into all four data-less panels and apply frosted glass effect to sidebar panel headers.

Purpose: Empty panels currently show plain text ("No stashes", "No tags"). This replaces them with polished line-art illustrations and friendly guidance text per user decision. Panel headers get glassmorphic styling. Loading states switch from spinners to skeleton placeholders.
Output: Updated StagingPanel, StashList, TagList, CommitHistory with EmptyState component. Updated RepositoryView with frosted glass headers.
</objective>

<execution_context>
@/Users/phmatray/.claude/get-shit-done/workflows/execute-plan.md
@/Users/phmatray/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/14-ui-polish/14-CONTEXT.md
@.planning/phases/14-ui-polish/14-RESEARCH.md
@src/components/staging/StagingPanel.tsx
@src/components/stash/StashList.tsx
@src/components/tags/TagList.tsx
@src/components/commit/CommitHistory.tsx
@src/components/RepositoryView.tsx
@src/components/ui/EmptyState.tsx
@src/components/ui/Skeleton.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add empty states and skeleton loaders to panels</name>
  <files>
    src/components/staging/StagingPanel.tsx
    src/components/stash/StashList.tsx
    src/components/tags/TagList.tsx
    src/components/commit/CommitHistory.tsx
  </files>
  <action>
Replace plain-text empty states with EmptyState component using Lucide icons as line-art illustrations (matching the "like Linear/GitHub" user decision). All icons use `currentColor` for theme compliance.

**StagingPanel.tsx:**

Import `EmptyState` from `../ui/EmptyState`, `Skeleton` from `../ui/Skeleton`, and `FileCheck` from `lucide-react`.

1. Replace the `isLoading` spinner block (lines 54-59) with skeleton loaders:
```tsx
if (isLoading) {
  return (
    <div className="p-3 space-y-3">
      <Skeleton className="h-4 w-24" />
      <div className="space-y-2">
        <Skeleton className="h-8 w-full" />
        <Skeleton className="h-8 w-full" />
        <Skeleton className="h-8 w-3/4" />
      </div>
      <Skeleton className="h-4 w-20" />
      <div className="space-y-2">
        <Skeleton className="h-8 w-full" />
        <Skeleton className="h-8 w-5/6" />
      </div>
    </div>
  );
}
```

2. Replace the `!hasChanges` empty state block (lines 82-87) with:
```tsx
if (!hasChanges) {
  return (
    <EmptyState
      icon={<FileCheck className="w-full h-full" />}
      title="All clear!"
      description="No changes to commit. Edit some files and they'll show up here."
    />
  );
}
```
No CTA button (staging is reactive -- no action button makes sense).

**StashList.tsx:**

Import `EmptyState` from `../ui/EmptyState`. The `Archive` icon is already imported.

Replace the "No stashes" text (line 49) with:
```tsx
<EmptyState
  icon={<Archive className="w-full h-full" />}
  title="Nothing stashed!"
  description="Stash changes when you need a clean working tree without committing."
/>
```
No CTA button (the + button in the section header already provides stash creation).

**TagList.tsx:**

Import `EmptyState` from `../ui/EmptyState` and `Plus` from `lucide-react`. `Tag` is already imported.

First, add an `onOpenCreateDialog?: () => void` prop to the interface:
```tsx
interface TagListProps {
  showCreateDialog: boolean;
  onCloseCreateDialog: () => void;
  onOpenCreateDialog?: () => void;
}
```

Destructure it in the component function parameters.

Replace the "No tags" text (line 40) with:
```tsx
<EmptyState
  icon={<Tag className="w-full h-full" />}
  title="No tags yet"
  description="Tags mark important points in history like releases."
  action={onOpenCreateDialog ? {
    label: "Create Tag",
    onClick: onOpenCreateDialog,
    icon: <Plus className="w-3.5 h-3.5 mr-1.5" />,
  } : undefined}
/>
```

Note: The parent (RepositoryView.tsx, handled in Task 2) will pass `onOpenCreateDialog` prop.

**CommitHistory.tsx:**

Import `EmptyState` from `../ui/EmptyState` and `Skeleton` from `../ui/Skeleton`. `GitCommit` is already imported.

1. Replace the loading spinner (lines 91-93) with skeleton loaders:
```tsx
{isLoading ? (
  <div className="p-3 space-y-2">
    {Array.from({ length: 6 }).map((_, i) => (
      <div key={`skeleton-${i}`} className="flex items-start gap-2 px-3 py-2">
        <Skeleton className="w-4 h-4 rounded-full shrink-0 mt-0.5" />
        <div className="flex-1 space-y-1.5">
          <Skeleton className="h-3.5 w-3/4" />
          <Skeleton className="h-3 w-1/2" />
        </div>
      </div>
    ))}
  </div>
) : ...
```

2. Replace the empty state text (lines 98-101) with:
```tsx
) : commits.length === 0 ? (
  <div className="flex items-center justify-center h-full">
    <EmptyState
      icon={<GitCommit className="w-full h-full" />}
      title={isSearching ? "No matching commits" : "Fresh start!"}
      description={isSearching ? "Try a different search term." : "Make your first commit and it will appear here."}
    />
  </div>
) : (
```
No CTA button (commit is done from the form in the left panel).
  </action>
  <verify>
Run `npx tsc --noEmit` to confirm no type errors. Verify each component imports EmptyState correctly. Verify the TagList interface now includes the optional `onOpenCreateDialog` prop.
  </verify>
  <done>
All four panels show EmptyState with line art illustrations and friendly casual guidance text. Tags panel has "Create Tag" CTA. StagingPanel and CommitHistory use skeleton loaders during initial data fetch instead of plain spinners.
  </done>
</task>

<task type="auto">
  <name>Task 2: Apply frosted glass to sidebar headers and wire TagList CTA</name>
  <files>
    src/components/RepositoryView.tsx
  </files>
  <action>
**Frosted glass headers:**

Update ALL FIVE `<summary>` elements in RepositoryView.tsx to use frosted glass styling.

Current classes on each summary (identical across all 5):
```
p-3 cursor-pointer hover:bg-ctp-surface0/50 flex items-center gap-2 select-none sticky top-0 bg-ctp-base z-10
```

Replace `bg-ctp-base` with frosted glass classes on each:
```
p-3 cursor-pointer hover:bg-ctp-surface0/50 flex items-center gap-2 select-none sticky top-0 z-10 bg-ctp-base/70 backdrop-blur-lg border-b border-ctp-surface0/50
```

Changes from current:
- `bg-ctp-base` becomes `bg-ctp-base/70` (semi-transparent, 70% opacity for glass effect)
- Add `backdrop-blur-lg` (16px blur, within user's 16-20px spec)
- Add `border-b border-ctp-surface0/50` (subtle bottom border for glass edge definition)

Apply to all 5 summary elements:
1. Branches section
2. Stashes section
3. Tags section
4. Gitflow section
5. Worktrees section

Keep the existing `border-b border-ctp-surface0` on the parent `<details>` elements unchanged (they separate sections from each other).

**Wire TagList CTA:**

Pass the `onOpenCreateDialog` prop to TagList so the "Create Tag" CTA works:

```tsx
<TagList
  showCreateDialog={showTagDialog}
  onCloseCreateDialog={() => setShowTagDialog(false)}
  onOpenCreateDialog={() => setShowTagDialog(true)}
/>
```

This connects the EmptyState's CTA button to the existing CreateTagDialog flow.
  </action>
  <verify>
Run `npx tsc --noEmit`. Run `npm run dev`, open a repository, and:
1. Scroll within a sidebar section -- the header should blur content behind it with a glass effect
2. All 5 sections should have identical frosted glass headers
3. Go to Tags section with no tags -- the "Create Tag" CTA button should open the create tag dialog
  </verify>
  <done>
All 5 sidebar panel headers (Branches, Stashes, Tags, Gitflow, Worktrees) have frosted glass effect with 70% opacity background and 16px backdrop blur. TagList empty state CTA opens the create tag dialog.
  </done>
</task>

</tasks>

<verification>
- `npx tsc --noEmit` passes with zero errors
- Empty StagingPanel shows FileCheck illustration + "All clear!" text
- Empty StashList shows Archive illustration + "Nothing stashed!" text
- Empty TagList shows Tag illustration + "No tags yet" + "Create Tag" CTA button that opens dialog
- Empty CommitHistory shows GitCommit illustration + "Fresh start!" text
- StagingPanel loading shows skeleton shapes (section header + file rows)
- CommitHistory loading shows skeleton shapes (commit row placeholders)
- All 5 summary headers have `backdrop-blur-lg` and `bg-ctp-base/70`
</verification>

<success_criteria>
- Four empty state panels render line art illustrations with friendly guidance text
- Tags empty state CTA opens the create tag dialog
- Loading states use skeleton loaders matching content layout
- All sidebar headers have visible frosted glass effect when content scrolls behind them
</success_criteria>

<output>
After completion, create `.planning/phases/14-ui-polish/14-02-SUMMARY.md`
</output>
