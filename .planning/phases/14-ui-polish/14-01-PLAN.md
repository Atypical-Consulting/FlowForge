---
phase: 14-ui-polish
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/ui/EmptyState.tsx
  - src/components/ui/ShortcutTooltip.tsx
  - src/components/ui/Skeleton.tsx
  - src/index.css
  - src/main.tsx
autonomous: true

must_haves:
  truths:
    - "EmptyState component renders SVG illustration, title, description, and optional CTA button"
    - "ShortcutTooltip shows tooltip with styled key badges on 500ms hover delay"
    - "Skeleton component renders shimmer placeholder shapes using Tailwind animate-pulse"
    - "Dirty pulse CSS keyframe animation exists as motion-safe:animate-dirty-pulse"
    - "MotionConfig at app root respects OS prefers-reduced-motion setting"
  artifacts:
    - path: "src/components/ui/EmptyState.tsx"
      provides: "Reusable empty state wrapper"
      exports: ["EmptyState"]
    - path: "src/components/ui/ShortcutTooltip.tsx"
      provides: "Tooltip with keyboard shortcut key badges"
      exports: ["ShortcutTooltip"]
    - path: "src/components/ui/Skeleton.tsx"
      provides: "Skeleton loader primitive"
      exports: ["Skeleton"]
    - path: "src/index.css"
      provides: "dirty-pulse keyframe and custom animation token"
      contains: "@keyframes dirty-pulse"
    - path: "src/main.tsx"
      provides: "MotionConfig wrapper at app root"
      contains: "MotionConfig"
  key_links:
    - from: "src/components/ui/EmptyState.tsx"
      to: "src/components/ui/button.tsx"
      via: "Button import for optional CTA"
      pattern: "import.*Button.*button"
    - from: "src/components/ui/ShortcutTooltip.tsx"
      to: "src/hooks/useKeyboardShortcuts.ts"
      via: "formatShortcut for OS-aware key display"
      pattern: "import.*formatShortcut"
---

<objective>
Create the reusable UI foundation components and CSS animations needed for Phase 14 polish work.

Purpose: All subsequent plans depend on these building blocks -- EmptyState for empty panels, ShortcutTooltip for keyboard hint badges, Skeleton for loading placeholders, dirty-pulse animation for the branch indicator, and MotionConfig for accessibility.
Output: Three new components in src/components/ui/, updated index.css with keyframes, updated main.tsx with MotionConfig.
</objective>

<execution_context>
@/Users/phmatray/.claude/get-shit-done/workflows/execute-plan.md
@/Users/phmatray/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/14-ui-polish/14-CONTEXT.md
@.planning/phases/14-ui-polish/14-RESEARCH.md
@src/components/ui/button.tsx
@src/hooks/useKeyboardShortcuts.ts
@src/lib/utils.ts
@src/lib/animations.ts
@src/index.css
@src/main.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create EmptyState, ShortcutTooltip, and Skeleton components</name>
  <files>
    src/components/ui/EmptyState.tsx
    src/components/ui/ShortcutTooltip.tsx
    src/components/ui/Skeleton.tsx
  </files>
  <action>
Create three new reusable components in src/components/ui/:

**EmptyState.tsx:**
- Props: `icon: ReactNode` (SVG illustration), `title: string`, `description: string`, `action?: { label: string; onClick: () => void; icon?: ReactNode }`, `className?: string`
- Layout: centered flex column with padding (p-8). Icon container at w-12 h-12 using `text-ctp-overlay0 mb-4`. Title as `text-sm font-medium text-ctp-subtext1 mb-1`. Description as `text-xs text-ctp-overlay0 max-w-[200px] mb-4`. Optional CTA using existing `Button` component with variant="outline" size="sm".
- Use `cn()` from `../../lib/utils` for className merging on the outer wrapper.
- The icon prop should be wrapped in a div that applies the size and color, so the icon itself uses `currentColor`.

**ShortcutTooltip.tsx:**
- Props: `shortcut: string` (e.g. "mod+shift+F"), `label: string` (e.g. "Fetch"), `children: ReactNode`, `side?: "top" | "bottom"` (default "bottom")
- Implementation: wrapper div with `relative inline-flex`. Children rendered directly. Tooltip appears on hover after 500ms delay using useState + useEffect with setTimeout/clearTimeout.
- On mouseEnter: start 500ms timer. On mouseLeave: clear timer and hide tooltip.
- Tooltip content layout: label text + key badges on same line. Parse shortcut using `formatShortcut()` from `../../hooks/useKeyboardShortcuts`. On Mac, split by empty string between symbols (each char is a key). On Windows/Linux, split by "+". Detect Mac via `navigator.platform.toUpperCase().indexOf("MAC") >= 0`.
- Key badge styling for each `<kbd>`: `inline-flex items-center justify-center min-w-[20px] h-5 px-1.5 text-[10px] font-mono font-medium rounded border border-ctp-surface2 bg-ctp-surface0 text-ctp-subtext1 shadow-[0_1px_0_0_var(--ctp-surface2)]`. This creates the raised key cap look like VS Code tooltips.
- Tooltip container: `absolute z-50 px-2.5 py-1.5 rounded-md bg-ctp-crust border border-ctp-surface0 shadow-lg pointer-events-none whitespace-nowrap`. Centering: `left-1/2 -translate-x-1/2`. Position for "bottom": `top-full mt-1.5`. For "top": `bottom-full mb-1.5`.
- Label inside tooltip: `<span className="text-xs text-ctp-subtext0 mr-2">{label}</span>` followed by kbd badges with `gap-0.5` flex container.
- Use AnimatePresence + motion.div from framer-motion for fade in/out (opacity 0->1, y: 2->0, duration 0.15s). Import `useReducedMotion` from framer-motion and skip the animation (render static) when reduced motion is preferred.

**Skeleton.tsx:**
- Simple component: accepts `className?: string` prop.
- Returns `<div className={cn("motion-safe:animate-pulse rounded bg-ctp-surface0", className)} />`
- Use `cn()` from `../../lib/utils`.
  </action>
  <verify>
Run `npx tsc --noEmit` to confirm no type errors. Verify all three files exist and export their named components.
  </verify>
  <done>
EmptyState renders illustration + title + description + optional CTA. ShortcutTooltip shows styled key badges on 500ms hover with OS-aware formatting. Skeleton renders shimmer shapes. All components type-check cleanly.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add dirty-pulse CSS animation and MotionConfig wrapper</name>
  <files>
    src/index.css
    src/main.tsx
  </files>
  <action>
**src/index.css** -- Add inside the existing `@theme { }` block (after the `--font-mono` definition, before the closing brace):

```css
--animate-dirty-pulse: dirty-pulse 2s ease-in-out infinite;
```

Then add a new `@keyframes dirty-pulse` block OUTSIDE the @theme block, after the existing `@keyframes dialog-content-show` block (around line 88):

```css
@keyframes dirty-pulse {
  0%, 100% {
    filter: drop-shadow(0 0 0px var(--ctp-yellow));
    opacity: 1;
  }
  50% {
    filter: drop-shadow(0 0 4px var(--ctp-yellow));
    opacity: 0.7;
  }
}
```

This allows usage as `motion-safe:animate-dirty-pulse` in Tailwind v4 classes.

**src/main.tsx** -- Add MotionConfig wrapper around App:

Add import: `import { MotionConfig } from "framer-motion";`

Wrap `<App />` inside MotionConfig in the render tree:
```tsx
<QueryClientProvider client={queryClient}>
  <MotionConfig reducedMotion="user">
    <App />
  </MotionConfig>
</QueryClientProvider>
```

This makes ALL framer-motion animations throughout the app automatically respect the user's `prefers-reduced-motion` OS setting without per-component changes.
  </action>
  <verify>
Run `npx tsc --noEmit` to confirm no type errors. Run `npm run dev` briefly to confirm the app still loads without errors. Verify `@keyframes dirty-pulse` exists in index.css and `MotionConfig` wraps App in main.tsx.
  </verify>
  <done>
dirty-pulse animation is available as `motion-safe:animate-dirty-pulse` Tailwind class. MotionConfig at app root respects OS reduced-motion preference for all framer-motion animations.
  </done>
</task>

</tasks>

<verification>
- `npx tsc --noEmit` passes with zero errors
- All three new component files exist in src/components/ui/
- index.css contains `@keyframes dirty-pulse` and `--animate-dirty-pulse`
- main.tsx imports and wraps with MotionConfig
- `npm run dev` starts without console errors
</verification>

<success_criteria>
- EmptyState, ShortcutTooltip, and Skeleton components are importable from src/components/ui/
- ShortcutTooltip uses formatShortcut() for OS-aware key display with styled kbd badges
- ShortcutTooltip has 500ms hover delay
- dirty-pulse CSS animation is defined and available via Tailwind class
- MotionConfig wraps the entire app with reducedMotion="user"
</success_criteria>

<output>
After completion, create `.planning/phases/14-ui-polish/14-01-SUMMARY.md`
</output>
