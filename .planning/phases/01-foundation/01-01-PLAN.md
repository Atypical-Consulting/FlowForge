---
phase: 01-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - Cargo.toml
  - src-tauri/Cargo.toml
  - src-tauri/tauri.conf.json
  - src-tauri/src/main.rs
  - src-tauri/src/lib.rs
  - src-tauri/build.rs
  - src-tauri/capabilities/default.json
  - src/App.tsx
  - src/main.tsx
  - src/index.css
  - src/bindings.ts
  - vite.config.ts
  - tsconfig.json
  - biome.json
autonomous: true

must_haves:
  truths:
    - "Application window opens on launch"
    - "React frontend renders in WebView"
    - "Tauri commands can be invoked from frontend"
    - "TypeScript types are generated from Rust"
  artifacts:
    - path: "src-tauri/src/main.rs"
      provides: "Tauri entry point"
      contains: "fn main"
    - path: "src-tauri/src/lib.rs"
      provides: "Command exports with specta"
      exports: ["run"]
    - path: "src/bindings.ts"
      provides: "Generated TypeScript bindings"
      contains: "commands"
    - path: "src/App.tsx"
      provides: "React root component"
      min_lines: 15
  key_links:
    - from: "src/App.tsx"
      to: "src/bindings.ts"
      via: "import { commands }"
      pattern: "import.*commands.*from.*bindings"
    - from: "src-tauri/src/lib.rs"
      to: "tauri-specta"
      via: "specta decorator"
      pattern: "specta::specta"
---

<objective>
Create the Tauri 2.x application scaffold with React frontend and type-safe IPC via tauri-specta.

Purpose: Establishes the foundational project structure that all subsequent development builds upon. This includes the Tauri backend, React frontend, build configuration, and the type-safe bridge between them.

Output: A working Tauri application that opens a window with a basic React UI, with TypeScript bindings generated from Rust command signatures.
</objective>

<execution_context>
@/Users/phmatray/.claude/get-shit-done/workflows/execute-plan.md
@/Users/phmatray/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/research/STACK.md
@.planning/phases/01-foundation/01-CONTEXT.md
@.planning/phases/01-foundation/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize Tauri 2.x Project with React</name>
  <files>
    package.json
    Cargo.toml
    src-tauri/Cargo.toml
    src-tauri/tauri.conf.json
    src-tauri/src/main.rs
    src-tauri/src/lib.rs
    src-tauri/build.rs
    vite.config.ts
    tsconfig.json
    src/main.tsx
    src/App.tsx
    src/index.css
    biome.json
  </files>
  <action>
    Create Tauri 2.x project using `npm create tauri-app@latest . -- --template react-ts` (use current directory).
    
    If prompted, choose:
    - Package manager: npm
    - UI template: React
    - TypeScript: Yes
    
    After creation, update src-tauri/Cargo.toml with these dependencies (versions from STACK.md):
    
    ```toml
    [package]
    name = "flowforge"
    version = "0.1.0"
    edition = "2021"
    
    [build-dependencies]
    tauri-build = { version = "2", features = [] }
    
    [dependencies]
    tauri = { version = "2", features = [] }
    tauri-plugin-opener = "2"
    serde = { version = "1", features = ["derive"] }
    serde_json = "1"
    tokio = { version = "1", features = ["full"] }
    thiserror = "2"
    ```
    
    Update src-tauri/tauri.conf.json:
    - Set "productName" to "FlowForge"
    - Set "identifier" to "com.flowforge.app"
    - Set window "title" to "FlowForge"
    - Set window "width" to 1200 and "height" to 800
    - Set window "visible" to false (prevents flash on startup - PITFALLS.md)
    
    Update package.json scripts:
    ```json
    {
      "scripts": {
        "dev": "vite",
        "build": "tsc && vite build",
        "preview": "vite preview",
        "tauri": "tauri",
        "check": "biome check --write ."
      }
    }
    ```
    
    Install additional frontend dependencies:
    ```bash
    npm install zustand @tanstack/react-query react-router lucide-react
    npm install -D @biomejs/biome tailwindcss @tailwindcss/vite
    ```
    
    Configure Tailwind CSS 4 in vite.config.ts:
    ```typescript
    import { defineConfig } from "vite";
    import react from "@vitejs/plugin-react";
    import tailwindcss from "@tailwindcss/vite";
    
    export default defineConfig({
      plugins: [react(), tailwindcss()],
      clearScreen: false,
      server: {
        strictPort: true,
      },
      envPrefix: ["VITE_", "TAURI_"],
      build: {
        target: process.env.TAURI_PLATFORM === "windows" ? "chrome105" : "safari13",
        minify: !process.env.TAURI_DEBUG ? "esbuild" : false,
        sourcemap: !!process.env.TAURI_DEBUG,
      },
    });
    ```
    
    Update src/index.css for Tailwind 4:
    ```css
    @import "tailwindcss";
    ```
    
    Create biome.json:
    ```json
    {
      "$schema": "https://biomejs.dev/schemas/1.9.0/schema.json",
      "organizeImports": { "enabled": true },
      "linter": { "enabled": true, "rules": { "recommended": true } },
      "formatter": { "enabled": true, "indentStyle": "space", "indentWidth": 2 }
    }
    ```
    
    Create basic src/App.tsx with placeholder:
    ```tsx
    function App() {
      return (
        <div className="flex flex-col items-center justify-center min-h-screen bg-gray-900 text-white">
          <h1 className="text-4xl font-bold">FlowForge</h1>
          <p className="mt-4 text-gray-400">Git client loading...</p>
        </div>
      );
    }
    
    export default App;
    ```
  </action>
  <verify>
    `npm run tauri dev` launches the application window with "FlowForge" visible.
    Window appears at approximately 1200x800 size.
  </verify>
  <done>
    Tauri application launches, React renders in WebView, window appears at correct size with dark background and FlowForge heading.
  </done>
</task>

<task type="auto">
  <name>Task 2: Configure Tauri Plugins and tauri-specta</name>
  <files>
    src-tauri/Cargo.toml
    src-tauri/tauri.conf.json
    src-tauri/capabilities/default.json
    src-tauri/src/lib.rs
    src-tauri/src/main.rs
    src/bindings.ts
  </files>
  <action>
    Add Tauri plugin and tauri-specta dependencies to src-tauri/Cargo.toml:
    
    ```toml
    [dependencies]
    tauri = { version = "2", features = [] }
    tauri-plugin-opener = "2"
    tauri-plugin-dialog = "2"
    tauri-plugin-store = "2"
    tauri-plugin-window-state = "2"
    tauri-specta = { version = "2.0.0-rc.21", features = ["derive", "typescript"] }
    specta = "2"
    specta-typescript = "0.0.9"
    serde = { version = "1", features = ["derive"] }
    serde_json = "1"
    tokio = { version = "1", features = ["full"] }
    thiserror = "2"
    ```
    
    Update src-tauri/capabilities/default.json to include plugin permissions:
    ```json
    {
      "$schema": "../gen/schemas/desktop-schema.json",
      "identifier": "default",
      "description": "Default capabilities for FlowForge",
      "windows": ["main"],
      "permissions": [
        "core:default",
        "opener:default",
        "dialog:default",
        "store:default",
        "window:default"
      ]
    }
    ```
    
    Update src-tauri/src/lib.rs to configure tauri-specta:
    
    ```rust
    use tauri_specta::{collect_commands, Builder};
    use specta_typescript::Typescript;
    
    #[tauri::command]
    #[specta::specta]
    async fn greet(name: String) -> String {
        format!("Hello, {}! Welcome to FlowForge.", name)
    }
    
    #[cfg_attr(mobile, tauri::mobile_entry_point)]
    pub fn run() {
        let builder = Builder::<tauri::Wry>::new()
            .commands(collect_commands![greet]);
    
        #[cfg(debug_assertions)]
        builder
            .export(Typescript::default(), "../src/bindings.ts")
            .expect("Failed to export TypeScript bindings");
    
        tauri::Builder::default()
            .plugin(tauri_plugin_opener::init())
            .plugin(tauri_plugin_dialog::init())
            .plugin(tauri_plugin_store::Builder::new().build())
            .plugin(tauri_plugin_window_state::Builder::new().build())
            .invoke_handler(builder.invoke_handler())
            .setup(move |app| {
                builder.mount_events(app);
                
                // Show window after setup to prevent flash (PITFALLS.md)
                if let Some(window) = app.get_webview_window("main") {
                    let _ = window.show();
                }
                
                Ok(())
            })
            .run(tauri::generate_context!())
            .expect("error while running tauri application");
    }
    ```
    
    Keep src-tauri/src/main.rs minimal:
    ```rust
    #![cfg_attr(not(debug_assertions), windows_subsystem = "windows")]
    
    fn main() {
        flowforge_lib::run()
    }
    ```
    
    Install frontend plugin packages:
    ```bash
    npm install @tauri-apps/plugin-dialog @tauri-apps/plugin-store @tauri-apps/plugin-window-state
    ```
    
    Build the Rust backend to generate bindings:
    ```bash
    cd src-tauri && cargo build
    ```
    
    Verify src/bindings.ts is generated with typed `commands.greet()` function.
  </action>
  <verify>
    `cargo build` in src-tauri/ succeeds without errors.
    src/bindings.ts exists and contains exported `commands` object with `greet` function.
    No TypeScript errors when importing from bindings.ts.
  </verify>
  <done>
    - Plugins initialized (dialog, store, window-state)
    - tauri-specta configured and generates TypeScript bindings on build
    - Test command `greet` available with full type safety
    - Window shows after setup (no flash)
  </done>
</task>

<task type="auto">
  <name>Task 3: Verify End-to-End IPC Round Trip</name>
  <files>
    src/App.tsx
  </files>
  <action>
    Update src/App.tsx to test the full IPC round-trip:
    
    ```tsx
    import { useState } from "react";
    import { commands } from "./bindings";
    
    function App() {
      const [greeting, setGreeting] = useState<string | null>(null);
      const [loading, setLoading] = useState(false);
      const [error, setError] = useState<string | null>(null);
    
      const handleGreet = async () => {
        setLoading(true);
        setError(null);
        try {
          const result = await commands.greet("Developer");
          setGreeting(result);
        } catch (e) {
          setError(e instanceof Error ? e.message : String(e));
          console.error("IPC error:", e);
        } finally {
          setLoading(false);
        }
      };
    
      return (
        <div className="flex flex-col items-center justify-center min-h-screen bg-gray-900 text-white">
          <h1 className="text-4xl font-bold mb-8">FlowForge</h1>
          
          <button
            onClick={handleGreet}
            disabled={loading}
            className="px-6 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-800 disabled:cursor-not-allowed rounded-lg font-medium transition-colors"
          >
            {loading ? "Loading..." : "Test IPC"}
          </button>
          
          {greeting && (
            <p className="mt-6 text-lg text-green-400">{greeting}</p>
          )}
          
          {error && (
            <p className="mt-6 text-lg text-red-400">Error: {error}</p>
          )}
          
          <p className="mt-8 text-sm text-gray-500">
            Click the button to verify Rust backend communication
          </p>
        </div>
      );
    }
    
    export default App;
    ```
    
    Run the application and verify:
    1. App launches without errors
    2. Clicking "Test IPC" button shows loading state
    3. Greeting from Rust appears: "Hello, Developer! Welcome to FlowForge."
    4. Tailwind CSS styling is applied correctly
    
    This confirms:
    - React renders correctly with Tailwind
    - TypeScript bindings are correctly typed (no compile errors)
    - Tauri IPC bridge works end-to-end (frontend -> Rust -> frontend)
    - Async command handling works properly
  </action>
  <verify>
    `npm run tauri dev` launches app.
    Clicking "Test IPC" button displays "Hello, Developer! Welcome to FlowForge." from Rust backend.
    No TypeScript errors in IDE or build output.
    No console errors in browser devtools.
  </verify>
  <done>
    - Full round-trip IPC working (React -> Rust -> React)
    - TypeScript types match Rust signatures
    - UI styled with Tailwind CSS
    - Error handling in place
    - Foundation ready for Git commands
  </done>
</task>

</tasks>

<verification>
1. `npm run tauri dev` launches the application
2. Window opens at 1200x800 with "FlowForge" title
3. React UI renders with dark background and Tailwind styling
4. Clicking "Test IPC" button shows greeting from Rust
5. src/bindings.ts exists and contains typed command functions
6. No TypeScript errors in IDE or during build
7. `cargo check` in src-tauri/ passes without warnings
8. Window appears without white flash on startup
</verification>

<success_criteria>
- Application window launches on the current platform
- React frontend renders in WebView with Tailwind styling
- Tauri plugins (dialog, store, window-state) initialized without errors
- tauri-specta generates TypeScript bindings automatically on cargo build
- IPC round-trip verified: frontend calls Rust command, receives typed response
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md`
</output>
