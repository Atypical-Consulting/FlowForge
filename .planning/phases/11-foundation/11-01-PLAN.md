---
phase: 11-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/stores/toast.ts
  - src/components/ui/Toast.tsx
  - src/components/ui/ToastContainer.tsx
  - src/App.tsx
autonomous: true

must_haves:
  truths:
    - "Toast notifications can be added to a queue"
    - "Multiple toasts stack visually (up to 3 visible)"
    - "Success toasts show progress bar and auto-dismiss after 5 seconds"
    - "Error toasts persist until user clicks dismiss"
    - "Toasts can include action buttons"
  artifacts:
    - path: "src/stores/toast.ts"
      provides: "Toast queue state management"
      exports: ["useToastStore", "toast"]
    - path: "src/components/ui/ToastContainer.tsx"
      provides: "Toast stack rendering"
      exports: ["ToastContainer"]
  key_links:
    - from: "src/App.tsx"
      to: "ToastContainer"
      via: "JSX mount"
      pattern: "<ToastContainer"
    - from: "src/components/ui/ToastContainer.tsx"
      to: "src/stores/toast.ts"
      via: "zustand hook"
      pattern: "useToastStore"
---

<objective>
Create toast notification system with queue management, stacking, auto-dismiss, and action buttons.

Purpose: Enable user feedback for all Git operations - the foundation that subsequent features build upon.
Output: Toast store, enhanced Toast component, ToastContainer mounted in App.
</objective>

<execution_context>
@C:\Users\matrayp\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\matrayp\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/11-foundation/11-CONTEXT.md
@.planning/phases/11-foundation/11-RESEARCH.md
@src/components/ui/Toast.tsx
@src/stores/theme.ts
@src/App.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Toast Store with Queue Management</name>
  <files>src/stores/toast.ts</files>
  <action>
Create zustand store for toast queue management following existing store patterns (see theme.ts).

Interface:
- ToastType: 'success' | 'error' | 'info' | 'warning'
- Toast: { id, type, message, action?: { label, onClick }, duration?, createdAt }
- ToastState: { toasts, addToast, removeToast, clearAll }

Implementation details:
- Generate unique ID with crypto.randomUUID()
- Store createdAt as Date.now() for ordering
- Default duration for success/info: 5000ms
- Default duration for error/warning: undefined (persist until dismissed)
- Export convenience helpers: toast.success(msg, action?), toast.error(msg, action?), etc.
- Helpers should return the toast ID for potential programmatic removal
  </action>
  <verify>TypeScript compiles: npx tsc --noEmit</verify>
  <done>Toast store exports useToastStore and toast helper object</done>
</task>

<task type="auto">
  <name>Task 2: Enhance Toast Component with Actions and Progress</name>
  <files>src/components/ui/Toast.tsx, src/components/ui/ToastContainer.tsx</files>
  <action>
Rewrite Toast.tsx to accept Toast object from store:
- Props: toast (full Toast object), onDismiss callback
- Render: icon (by type), message, optional action button, dismiss X button
- Progress bar for auto-dismiss toasts (framer-motion animate width from 100% to 0%)
- Use existing Catppuccin colors: ctp-green (success), ctp-red (error), ctp-blue (info), ctp-yellow (warning)

Create ToastContainer.tsx:
- Fixed position: bottom-4 right-4
- Stack direction: flex-col-reverse (newest at bottom, older above)
- Show max 3 toasts (slice last 3 from array)
- Use AnimatePresence with layout for smooth reordering
- Animation: initial={{ opacity: 0, y: 50 }}, animate={{ opacity: 1, y: 0 }}, exit={{ opacity: 0, scale: 0.9 }}
- z-index: 50 (matches existing Toast)

Auto-dismiss logic in ToastContainer:
- For each toast with duration, set timeout to remove after duration ms
- Clear timeouts on unmount or when toast is manually dismissed
- Track timeout IDs in a ref to prevent memory leaks
  </action>
  <verify>npm run tauri dev - app starts without errors</verify>
  <done>Toast renders with actions, progress bars; ToastContainer stacks correctly</done>
</task>

<task type="auto">
  <name>Task 3: Mount ToastContainer in App</name>
  <files>src/App.tsx</files>
  <action>
Import ToastContainer from './components/ui/ToastContainer'.
Add ToastContainer as last child in the root div, after ChangelogDialog.
This ensures toasts render above all other content.

Do NOT add any test toasts - Plan 11-04 wires operations to toasts.
  </action>
  <verify>npm run tauri dev - app renders without errors, inspect DOM to confirm ToastContainer present</verify>
  <done>ToastContainer mounted in App, ready to display toasts</done>
</task>

</tasks>

<verification>
1. npm run tauri dev - app starts without errors
2. npx tsc --noEmit - TypeScript compiles
3. Toast store exists at src/stores/toast.ts with expected exports
4. ToastContainer renders in DOM (empty initially)
</verification>

<success_criteria>
- Toast store manages queue with add/remove/clear operations
- Toast component renders with optional actions and progress bar
- ToastContainer stacks up to 3 toasts with animations
- Requirements UI-02, UI-03, UI-04 foundations in place
</success_criteria>

<output>
After completion, create .planning/phases/11-foundation/11-01-SUMMARY.md
</output>
