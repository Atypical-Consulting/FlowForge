---
phase: 11-foundation
plan: 04
type: execute
wave: 2
depends_on: ["11-01"]
files_modified:
  - src/components/commit/CommitForm.tsx
  - src/components/sync/SyncButtons.tsx
  - src/hooks/useKeyboardShortcuts.ts
  - src/components/branches/BranchList.tsx
autonomous: true

must_haves:
  truths:
    - "User sees toast after successful commit with Push now action"
    - "User sees toast after push/pull/fetch operations"
    - "Error toasts show Retry button for retryable operations"
    - "Toast appears for merge operations"
  artifacts:
    - path: "src/components/commit/CommitForm.tsx"
      provides: "Commit success/error toasts"
    - path: "src/components/sync/SyncButtons.tsx"
      provides: "Push/pull/fetch toasts"
  key_links:
    - from: "src/components/commit/CommitForm.tsx"
      to: "src/stores/toast.ts"
      via: "toast helper"
      pattern: "toast\\.success|toast\\.error"
    - from: "src/components/sync/SyncButtons.tsx"
      to: "src/stores/toast.ts"
      via: "toast helper"
      pattern: "toast\\.success|toast\\.error"
---

<objective>
Wire toast notifications to Git operations: commit, push, pull, fetch, merge.

Purpose: Provide users with visual feedback for all Git operations as specified in requirements UI-01 through UI-04.
Output: All major Git operations trigger appropriate toast notifications.
</objective>

<execution_context>
@C:\Users\matrayp\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\matrayp\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/11-foundation/11-CONTEXT.md
@.planning/phases/11-foundation/11-01-SUMMARY.md
@src/stores/toast.ts
@src/components/commit/CommitForm.tsx
@src/components/sync/SyncButtons.tsx
@src/hooks/useKeyboardShortcuts.ts
@src/components/branches/BranchList.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Wire Toasts to Commit and Sync Operations</name>
  <files>src/components/commit/CommitForm.tsx, src/components/sync/SyncButtons.tsx</files>
  <action>
CommitForm.tsx:
- Import toast from stores/toast
- In commitMutation onSuccess:
  - Show success toast: "Committed: {first 50 chars of message}"
  - Include action: { label: "Push now", onClick: () => pushMutation.mutate() }
  - Need to add pushMutation similar to useKeyboardShortcuts.ts
- In commitMutation onError:
  - Show error toast: "Commit failed: {error message}"
  - No retry action (user needs to fix the issue)

SyncButtons.tsx:
- Import toast from stores/toast
- For each operation (push, pull, fetch), update the mutation:

Push onSuccess: toast.success("Pushed to {remote}")
Push onError: toast.error("Push failed: {error}", { label: "Retry", onClick: () => pushMutation.mutate() })

Pull onSuccess: toast.success("Pulled from {remote}")
Pull onError: toast.error("Pull failed: {error}", { label: "Retry", onClick: () => pullMutation.mutate() })

Fetch onSuccess: toast.success("Fetched from {remote}")
Fetch onError: toast.error("Fetch failed: {error}", { label: "Retry", onClick: () => fetchMutation.mutate() })

Error messages should be concise - extract key info from error object.
  </action>
  <verify>npm run tauri dev - make a commit, see toast with "Push now" button; push/pull/fetch show toasts</verify>
  <done>Commit and sync operations show appropriate toasts</done>
</task>

<task type="auto">
  <name>Task 2: Wire Toasts to Keyboard Shortcuts and Merge</name>
  <files>src/hooks/useKeyboardShortcuts.ts, src/components/branches/BranchList.tsx</files>
  <action>
useKeyboardShortcuts.ts:
- Import toast from stores/toast
- Update each mutation's onSuccess/onError:

stageAllMutation:
- onSuccess: toast.success("Staged all changes")
- onError: toast.error("Failed to stage: {error}")

pushMutation:
- onSuccess: toast.success("Pushed to origin")
- onError: toast.error("Push failed", { label: "Retry", onClick: retry })

pullMutation:
- onSuccess: toast.success("Pulled from origin")
- onError: toast.error("Pull failed", { label: "Retry", onClick: retry })

fetchMutation:
- onSuccess: toast.success("Fetched from origin")
- onError: toast.error("Fetch failed", { label: "Retry", onClick: retry })

BranchList.tsx (find merge operation):
- Locate the merge mutation
- onSuccess: toast.success("Merged {branch} into {currentBranch}")
- onError: toast.error("Merge failed: {error}")

Note: The merge dialog likely has its own mutation. Find where merge is called (MergeDialog.tsx or BranchList.tsx) and add toasts there.
  </action>
  <verify>npm run tauri dev - use keyboard shortcuts (Ctrl+Shift+P for push), see toasts; merge branch, see toast</verify>
  <done>All keyboard shortcuts and merge operations show toasts</done>
</task>

</tasks>

<verification>
1. npm run tauri dev
2. Stage files and commit - see toast with "Push now" action
3. Click "Push now" or use Ctrl+Shift+P - see push toast
4. Pull (Ctrl+Shift+L) - see pull toast
5. Fetch (Ctrl+Shift+F) - see fetch toast
6. Merge a branch - see merge toast
7. Trigger an error (e.g., push without remote) - see error toast with Retry
</verification>

<success_criteria>
- Toast appears after every commit with "Push now" action
- Toast appears after push/pull/fetch operations
- Error toasts include Retry button for network operations
- Merge operations show toast
- Requirement UI-01 fully satisfied
</success_criteria>

<output>
After completion, create .planning/phases/11-foundation/11-04-SUMMARY.md
</output>
