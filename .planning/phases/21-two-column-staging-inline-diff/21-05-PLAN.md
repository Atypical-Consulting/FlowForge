---
phase: 21-two-column-staging-inline-diff
plan: 05
type: execute
wave: 4
depends_on: ["21-03", "21-04"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "All success criteria from the phase are verified by a human"
    - "Two-column layout renders correctly across all staging states"
    - "Keyboard navigation and expand/back transitions work smoothly"
  artifacts: []
  key_links: []
---

<objective>
Verify the complete two-column staging experience end-to-end. Confirm all locked decisions from CONTEXT.md are implemented correctly.

Purpose: Human verification of the visual and interactive experience before marking Phase 21 complete.

Output: Verification results confirming phase completion.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/21-two-column-staging-inline-diff/21-03-SUMMARY.md
@.planning/phases/21-two-column-staging-inline-diff/21-04-SUMMARY.md
@.planning/phases/21-two-column-staging-inline-diff/CONTEXT.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete two-column staging layout with inline diff preview, keyboard navigation, expand-to-full-blade transition, and next/prev file navigation in full-screen mode.
  </what-built>
  <how-to-verify>
**Pre-flight:** `npm run dev` to start the dev server. Open a repository with changed files (staged, unstaged, and ideally untracked).

**1. Two-Column Layout (UX-01):**
- [ ] File list on left (~40%), diff preview on right (~60%)
- [ ] Resize handle between panels -- drag it to resize
- [ ] Resize is persistent (reload, resize stays)
- [ ] Both panels shrink proportionally when window narrows (no collapse)

**2. File Selection:**
- [ ] First file is auto-selected on load, diff shown immediately (no empty state)
- [ ] Click another file -- diff updates instantly in the right panel
- [ ] No new blade is pushed (blade strip does NOT appear on the left)

**3. Stage/Unstage While Viewing:**
- [ ] Stage a file (click + button) -- file moves to "Staged Changes" section but stays selected
- [ ] Diff stays visible for the same file
- [ ] Unstage it back -- same behavior, file returns to original section

**4. Keyboard Navigation:**
- [ ] Click in the file list to focus it
- [ ] Arrow Down -- selects next file, diff updates
- [ ] Arrow Up -- selects previous file, diff updates
- [ ] Space -- toggles stage/unstage for selected file
- [ ] Enter -- expands to full-screen diff blade

**5. Expand to Full Blade (UX-02):**
- [ ] Click the maximize icon (top-right of diff panel) -- full diff blade opens
- [ ] Staging blade collapses to a BladeStrip on the left
- [ ] Full diff blade has inline/side-by-side toggle (existing behavior)

**6. File Navigation in Full-Screen Diff:**
- [ ] Prev/next arrows visible in the toolbar with "N / M" counter
- [ ] Click next -- diff changes to next file, title updates, counter increments
- [ ] Alt+Down -- same as clicking next
- [ ] Alt+Up -- same as clicking prev

**7. Back Navigation:**
- [ ] Click Back or press Escape from full-screen diff
- [ ] Returns to two-column view with the same file selected
- [ ] Diff shows for that file in the right panel

**8. Non-Text Files:**
- [ ] If you have a binary/image file in changes, select it
- [ ] Right panel shows a placeholder with icon and "click to expand" message
- [ ] Click "Open in Full View" -- opens appropriate viewer blade

**9. Visual Quality:**
- [ ] Catppuccin theme colors throughout
- [ ] Clean resize handle (matches sidebar handle styling)
- [ ] File path in diff header: directory dimmed, filename bold
- [ ] Selected file in list: blue-tinted background with left blue border
  </how-to-verify>
  <resume-signal>Type "approved" if all checks pass, or describe issues to fix.</resume-signal>
</task>

</tasks>

<verification>
All items in the human-verify checklist above pass.
</verification>

<success_criteria>
Phase 21 is complete: both UX-01 (two-column layout with inline diff) and UX-02 (expand to full-screen diff blade) are verified by the user.
</success_criteria>

<output>
After completion, create `.planning/phases/21-two-column-staging-inline-diff/21-05-SUMMARY.md`
</output>
