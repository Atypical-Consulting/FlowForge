# Phase 6.1: Catppuccin Mocha File Icons - Research

**Researched:** 2026-02-04
**Domain:** React SVG Icons / File Type Visualization
**Confidence:** HIGH

## Summary

This phase adds Catppuccin Mocha-themed file icons to the changes view, replacing or supplementing the current generic status-based icons (FilePlus, FileMinus, FileEdit, FileQuestion from Lucide). The goal is visual differentiation by file type/extension while maintaining the existing dark theme aesthetic.

The Catppuccin VSCode Icons repository provides 656+ SVG icons under MIT license, using the Mocha color palette. These icons are stroke-based, 16x16 pixels, and use consistent styling (`stroke-linecap="round"`, `stroke-linejoin="round"`, `fill="none"`). Each icon uses a specific Mocha palette color (e.g., TypeScript uses Blue `#89b4fa`, JSON uses Yellow `#f9e2af`, Markdown uses Sapphire `#74c7ec`).

For a Vite + React project, the recommended approach is to use `vite-plugin-svgr` to import SVG files as React components, enabling tree-shaking and inline rendering with full CSS/prop control.

**Primary recommendation:** Create a curated set of ~30-40 file type icons as React components, with an extension-to-icon mapping utility, and integrate into the existing `FileItem.tsx` component.

## Standard Stack

### Core
| Library | Version | Purpose | Why Standard |
|---------|---------|---------|--------------|
| vite-plugin-svgr | latest | Transform SVGs to React components | Official SVGR Vite integration, tree-shakable, TypeScript support |
| Catppuccin Mocha Icons | N/A (raw SVGs) | Source icon files | MIT licensed, 656+ icons, consistent palette |

### Supporting
| Library | Version | Purpose | When to Use |
|---------|---------|---------|-------------|
| @catppuccin/palette | latest | Programmatic color access | If dynamic theming needed later |

### Alternatives Considered
| Instead of | Could Use | Tradeoff |
|------------|-----------|----------|
| vite-plugin-svgr | Inline SVG strings | More manual work, no TypeScript imports |
| vite-plugin-svgr | SVG sprite | Better for 100+ icons, more complex setup |
| Catppuccin icons | react-vscode-icons | Different color scheme, not Catppuccin |
| Catppuccin icons | @react-symbols/icons | Different style, 200+ icons but not Catppuccin palette |

**Installation:**
```bash
npm install --save-dev vite-plugin-svgr
```

## Architecture Patterns

### Recommended Project Structure
```
src/
├── assets/
│   └── icons/
│       └── file-types/           # Catppuccin Mocha SVG files
│           ├── typescript.svg
│           ├── javascript.svg
│           ├── rust.svg
│           ├── markdown.svg
│           ├── json.svg
│           ├── _file.svg         # Default file icon
│           ├── _folder.svg       # Closed folder icon
│           └── ...
├── components/
│   └── icons/
│       └── FileTypeIcon.tsx      # Icon selector component
└── lib/
    └── file-icons.ts             # Extension-to-icon mapping
```

### Pattern 1: Extension-to-Icon Mapping
**What:** A lookup table mapping file extensions to icon components
**When to use:** When rendering file lists, determining which icon to show
**Example:**
```typescript
// src/lib/file-icons.ts
import TypeScriptIcon from '@/assets/icons/file-types/typescript.svg?react';
import JavaScriptIcon from '@/assets/icons/file-types/javascript.svg?react';
import RustIcon from '@/assets/icons/file-types/rust.svg?react';
import DefaultFileIcon from '@/assets/icons/file-types/_file.svg?react';
import FolderIcon from '@/assets/icons/file-types/_folder.svg?react';

const extensionMap: Record<string, React.ComponentType<React.SVGProps<SVGSVGElement>>> = {
  '.ts': TypeScriptIcon,
  '.tsx': TypeScriptIcon,  // or typescript-react if available
  '.js': JavaScriptIcon,
  '.jsx': JavaScriptIcon,
  '.rs': RustIcon,
  '.md': MarkdownIcon,
  '.json': JsonIcon,
  // ... more mappings
};

export function getFileIcon(filename: string, isDirectory: boolean = false) {
  if (isDirectory) return FolderIcon;
  
  const ext = '.' + filename.split('.').pop()?.toLowerCase();
  return extensionMap[ext] || DefaultFileIcon;
}
```

### Pattern 2: FileTypeIcon Component
**What:** A wrapper component that selects the appropriate icon
**When to use:** In FileItem and FileTreeView components
**Example:**
```typescript
// src/components/icons/FileTypeIcon.tsx
import { getFileIcon } from '@/lib/file-icons';
import { cn } from '@/lib/utils';

interface FileTypeIconProps {
  filename: string;
  isDirectory?: boolean;
  className?: string;
}

export function FileTypeIcon({ filename, isDirectory = false, className }: FileTypeIconProps) {
  const IconComponent = getFileIcon(filename, isDirectory);
  return <IconComponent className={cn('w-4 h-4', className)} />;
}
```

### Pattern 3: Dual Icon Display (Status + Type)
**What:** Show both file type icon and git status indicator
**When to use:** When both file type and change status are important
**Example:**
```typescript
// In FileItem.tsx
<div className="flex items-center gap-1">
  <FileTypeIcon filename={file.path} className="w-4 h-4" />
  <StatusIndicator status={file.status} className="w-2 h-2" /> {/* Small dot indicator */}
</div>
```

### Anti-Patterns to Avoid
- **Importing all icons unconditionally:** Will bloat bundle even if unused. Use dynamic imports or ensure tree-shaking works.
- **Re-exporting from single index file:** Prevents tree-shaking. Keep individual imports.
- **Hardcoding colors in components:** SVGs already have Catppuccin colors; don't override unless theming.

## Don't Hand-Roll

| Problem | Don't Build | Use Instead | Why |
|---------|-------------|-------------|-----|
| SVG to React component conversion | Manual JSX conversion | vite-plugin-svgr | Automated, type-safe, optimized |
| File extension parsing | Complex regex patterns | Simple string split | Extensions are straightforward |
| Icon color palette | Custom color values | Catppuccin SVGs as-is | Pre-themed, consistent |

**Key insight:** The Catppuccin icons already contain the correct Mocha colors embedded in the SVG. Do not strip colors and re-apply with CSS classes - use the icons as-is.

## Common Pitfalls

### Pitfall 1: Bundle Size Bloat
**What goes wrong:** Including all 656 icons increases bundle significantly
**Why it happens:** Eager imports of unused icons
**How to avoid:** Curate a subset of ~30-40 common extensions; ensure tree-shaking is working
**Warning signs:** Initial bundle size jumps by >100KB

### Pitfall 2: Missing TypeScript Declarations
**What goes wrong:** TypeScript errors when importing `.svg?react`
**Why it happens:** Missing type declarations for the query parameter
**How to avoid:** Add to `vite-env.d.ts`:
```typescript
/// <reference types="vite-plugin-svgr/client" />
```
**Warning signs:** "Cannot find module '*.svg?react'" errors

### Pitfall 3: Incorrect Icon Sizing
**What goes wrong:** Icons appear too large or small, inconsistent with UI
**Why it happens:** SVG viewBox preserved but className width/height not applied
**How to avoid:** Use `className="w-4 h-4"` and ensure SVG has proper viewBox
**Warning signs:** Icons overflow containers or appear blurry

### Pitfall 4: Status vs Type Icon Confusion
**What goes wrong:** Users can't tell if file is modified/added/deleted
**Why it happens:** File type icon replaces status icon entirely
**How to avoid:** Either keep both (type + small status dot) or use color coding on type icons
**Warning signs:** User feedback about losing change visibility

### Pitfall 5: Case Sensitivity in Extensions
**What goes wrong:** `.TS` files don't match `.ts` mapping
**Why it happens:** Direct string comparison without normalization
**How to avoid:** Always `.toLowerCase()` the extension before lookup
**Warning signs:** Some TypeScript files show default icon

## Code Examples

### Vite Configuration
```typescript
// vite.config.ts
import tailwindcss from "@tailwindcss/vite";
import react from "@vitejs/plugin-react";
import svgr from "vite-plugin-svgr";
import { defineConfig } from "vite";

export default defineConfig({
  plugins: [
    react(),
    tailwindcss(),
    svgr({
      svgrOptions: {
        plugins: ["@svgr/plugin-svgo", "@svgr/plugin-jsx"],
        svgoConfig: {
          floatPrecision: 2,
        },
      },
      include: "**/*.svg?react",
    }),
  ],
  // ... rest of config
});
```

### Type Declaration
```typescript
// src/vite-env.d.ts
/// <reference types="vite/client" />
/// <reference types="vite-plugin-svgr/client" />
```

### Integration in FileItem.tsx
```typescript
// Modified FileItem.tsx
import { FileTypeIcon } from '@/components/icons/FileTypeIcon';

// In the component:
<div className="flex items-center gap-2 px-3 py-1.5 cursor-pointer group">
  <FileTypeIcon filename={displayName} className="w-4 h-4 shrink-0" />
  {/* Keep status as small indicator */}
  <span className={cn(
    "w-1.5 h-1.5 rounded-full shrink-0",
    file.status === 'added' && "bg-green-500",
    file.status === 'modified' && "bg-yellow-500",
    file.status === 'deleted' && "bg-red-500",
    file.status === 'untracked' && "bg-gray-500"
  )} />
  <span className="flex-1 truncate text-sm text-gray-200">
    {displayName}
  </span>
  {/* ... rest of component */}
</div>
```

### Folder Icon in FileTreeView.tsx
```typescript
// Modified FileTreeView.tsx
import { FileTypeIcon } from '@/components/icons/FileTypeIcon';

// In TreeNode:
<button className="flex items-center gap-1 ...">
  {expanded ? <ChevronDown className="w-3 h-3" /> : <ChevronRight className="w-3 h-3" />}
  <FileTypeIcon filename={node.name} isDirectory={true} className="w-4 h-4" />
  <span>{node.name}</span>
</button>
```

## State of the Art

| Old Approach | Current Approach | When Changed | Impact |
|--------------|------------------|--------------|--------|
| Font icon libraries | Inline SVG components | 2022+ | Better tree-shaking, styling control |
| Manual SVG-to-JSX | SVGR automation | 2019+ | Faster workflow, fewer errors |
| Single icon index export | Individual component files | 2023+ | Proper tree-shaking |

**Deprecated/outdated:**
- `react-svg-loader`: Superseded by SVGR
- Icon fonts (FontAwesome-style): SVGs preferred for flexibility

## Catppuccin Mocha Color Reference

Key colors used in file type icons:

| Color | Hex | Used For |
|-------|-----|----------|
| Blue | #89b4fa | TypeScript, CSS |
| Yellow | #f9e2af | JavaScript, JSON |
| Peach | #fab387 | Rust, HTML |
| Sapphire | #74c7ec | Markdown, Text |
| Green | #a6e3a1 | Vue, Test files |
| Mauve | #cba6f7 | Config files |
| Text | #cdd6f4 | Default/generic files |
| Lavender | #b4befe | Folders |

## Recommended Icon Subset (Priority)

Start with these ~35 common file types:

**Programming Languages:**
- typescript.svg, javascript.svg, rust.svg, python.svg, go.svg
- java.svg, csharp.svg, cpp.svg, c.svg, ruby.svg, php.svg

**Web/Markup:**
- html.svg, css.svg, scss.svg, vue.svg, svelte.svg
- typescript-react.svg (for .tsx)

**Data/Config:**
- json.svg, yaml.svg, toml.svg, xml.svg
- markdown.svg, txt.svg

**Build/Package:**
- package.svg (package.json), cargo.svg (Cargo.toml)
- dockerfile.svg, gitignore.svg

**Default:**
- _file.svg (unknown files)
- _folder.svg, _folder-open.svg (directories)

## Open Questions

1. **Open folder vs closed folder icon:**
   - Catppuccin may have both `_folder.svg` and `_folder-open.svg`
   - Decision: Use open for expanded, closed for collapsed directories

2. **Status icon retention:**
   - Should the git status (added/modified/deleted) remain visible?
   - Recommendation: Yes, use small colored dot alongside file type icon

3. **Exact icon count:**
   - Start with ~35, expand based on user feedback
   - Full 656 icons not needed initially

## Sources

### Primary (HIGH confidence)
- [Catppuccin VSCode Icons Repository](https://github.com/catppuccin/vscode-icons) - Icon source, MIT license, 656+ icons
- [Catppuccin Palette](https://catppuccin.com/palette/) - Official Mocha color values
- [vite-plugin-svgr npm](https://www.npmjs.com/package/vite-plugin-svgr) - SVG to React component plugin

### Secondary (MEDIUM confidence)
- [DEV.to: Importing SVG files as React components with Vite](https://dev.to/cassidoo/importing-svg-files-as-react-components-with-vite-l3n) - Integration pattern
- [LogRocket: A guide to using SVGs in React](https://blog.logrocket.com/guide-svgs-react/) - Best practices

### Tertiary (LOW confidence)
- [Lineicons: Top 11 React Icon Libraries for 2026](https://lineicons.com/blog/react-icon-libraries) - Ecosystem overview

## Metadata

**Confidence breakdown:**
- Standard stack: HIGH - Official documentation verified
- Architecture: HIGH - Existing codebase analyzed, clear patterns
- Pitfalls: MEDIUM - Based on general React/SVG best practices

**Research date:** 2026-02-04
**Valid until:** 2026-03-04 (stable domain, 30 days)
