---
phase: 06.1-catppuccin-mocha-file-icons
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - vite.config.ts
  - src/vite-env.d.ts
  - src/assets/icons/file-types/*.svg
  - src/lib/file-icons.ts
  - src/components/icons/FileTypeIcon.tsx
autonomous: true

must_haves:
  truths:
    - "SVG files can be imported as React components"
    - "Extension-to-icon mapping returns correct icon for common file types"
    - "FileTypeIcon component renders appropriate icon for any file path"
    - "Default file icon renders for unknown extensions"
  artifacts:
    - path: "src/vite-env.d.ts"
      provides: "TypeScript declarations for SVG imports"
      contains: "vite-plugin-svgr/client"
    - path: "src/lib/file-icons.ts"
      provides: "Extension-to-icon mapping utility"
      exports: ["getFileIcon", "FILE_ICON_MAP"]
    - path: "src/components/icons/FileTypeIcon.tsx"
      provides: "File type icon selector component"
      exports: ["FileTypeIcon"]
  key_links:
    - from: "src/components/icons/FileTypeIcon.tsx"
      to: "src/lib/file-icons.ts"
      via: "getFileIcon function import"
      pattern: "import.*getFileIcon.*from.*file-icons"
    - from: "vite.config.ts"
      to: "vite-plugin-svgr"
      via: "plugin configuration"
      pattern: "svgr\\(\\)"
---

<objective>
Set up SVG infrastructure and create Catppuccin Mocha file type icons

Purpose: Enable file-type-specific icons in the changes view by establishing the SVG import pipeline, downloading curated icons, and creating the icon selection logic.

Output: Working FileTypeIcon component that renders appropriate Catppuccin Mocha icons for ~35 common file types.
</objective>

<execution_context>
@/Users/phmatray/.claude/get-shit-done/workflows/execute-plan.md
@/Users/phmatray/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06.1-catppuccin-mocha-file-icons/06.1-RESEARCH.md
@vite.config.ts
@package.json
@tsconfig.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Configure vite-plugin-svgr and TypeScript declarations</name>
  <files>
    - package.json
    - vite.config.ts
    - src/vite-env.d.ts
  </files>
  <action>
1. Install vite-plugin-svgr:
   ```bash
   npm install --save-dev vite-plugin-svgr
   ```

2. Update vite.config.ts to add svgr plugin:
   ```typescript
   import svgr from 'vite-plugin-svgr';
   // Add to plugins array: svgr()
   ```
   Place svgr() before react() in the plugins array.

3. Create src/vite-env.d.ts with TypeScript declarations:
   ```typescript
   /// <reference types="vite/client" />
   /// <reference types="vite-plugin-svgr/client" />
   ```

4. Update tsconfig.json to include the new .d.ts file if needed (it should already include "src").
  </action>
  <verify>
    - `npm run build` completes without errors
    - TypeScript recognizes `?react` imports from SVG files
  </verify>
  <done>vite-plugin-svgr installed and configured, TypeScript declarations in place</done>
</task>

<task type="auto">
  <name>Task 2: Download curated Catppuccin Mocha icons and create mapping</name>
  <files>
    - src/assets/icons/file-types/*.svg (40 files)
    - src/lib/file-icons.ts
  </files>
  <action>
1. Create directory: `src/assets/icons/file-types/`

2. Download these icons from https://raw.githubusercontent.com/catppuccin/vscode-icons/main/icons/mocha/:
   
   **Programming Languages (15):**
   - typescript.svg, javascript.svg, rust.svg, python.svg, go.svg
   - java.svg, csharp.svg, cpp.svg, c.svg, ruby.svg
   - php.svg, swift.svg, kotlin.svg, lua.svg, console.svg (for shell/bash)
   
   **Web/Frontend (8):**
   - html.svg, css.svg, scss.svg, vue.svg, svelte.svg
   - react.svg (for .tsx/.jsx), astro.svg, angular.svg
   
   **Data/Config (8):**
   - json.svg, yaml.svg, toml.svg, xml.svg
   - markdown.svg, document.svg (for .txt), csv.svg, database.svg (for .sql)
   
   **Build/Project (6):**
   - nodejs.svg (for package.json), rust.svg (for Cargo.toml - reuse)
   - docker.svg (for Dockerfile and docker-compose)
   - git.svg (.gitignore), certificate.svg (for LICENSE)
   
   **Default/Folder (3):**
   - document.svg (default file), folder.svg, folder-open.svg
   
   Use curl to download each SVG. Create a bash script or run commands like:
   ```bash
   mkdir -p src/assets/icons/file-types
   curl -o src/assets/icons/file-types/typescript.svg \
     https://raw.githubusercontent.com/catppuccin/vscode-icons/main/icons/mocha/typescript.svg
   ```
   
   Note: Icon names on GitHub may differ slightly. Check the actual repository for exact filenames (e.g., "console.svg" vs "bash.svg", "document.svg" vs "file.svg").

3. Create src/lib/file-icons.ts with extension-to-icon mapping:
   ```typescript
   import type { ComponentType, SVGProps } from "react";
   
   // Import all icons using ?react suffix for SVGR
   import TypeScriptIcon from "@/assets/icons/file-types/typescript.svg?react";
   import JavaScriptIcon from "@/assets/icons/file-types/javascript.svg?react";
   import RustIcon from "@/assets/icons/file-types/rust.svg?react";
   import PythonIcon from "@/assets/icons/file-types/python.svg?react";
   import GoIcon from "@/assets/icons/file-types/go.svg?react";
   import JavaIcon from "@/assets/icons/file-types/java.svg?react";
   import CSharpIcon from "@/assets/icons/file-types/csharp.svg?react";
   import CppIcon from "@/assets/icons/file-types/cpp.svg?react";
   import CIcon from "@/assets/icons/file-types/c.svg?react";
   import RubyIcon from "@/assets/icons/file-types/ruby.svg?react";
   import PhpIcon from "@/assets/icons/file-types/php.svg?react";
   import SwiftIcon from "@/assets/icons/file-types/swift.svg?react";
   import KotlinIcon from "@/assets/icons/file-types/kotlin.svg?react";
   import LuaIcon from "@/assets/icons/file-types/lua.svg?react";
   import ConsoleIcon from "@/assets/icons/file-types/console.svg?react";
   import HtmlIcon from "@/assets/icons/file-types/html.svg?react";
   import CssIcon from "@/assets/icons/file-types/css.svg?react";
   import ScssIcon from "@/assets/icons/file-types/scss.svg?react";
   import VueIcon from "@/assets/icons/file-types/vue.svg?react";
   import SvelteIcon from "@/assets/icons/file-types/svelte.svg?react";
   import ReactIcon from "@/assets/icons/file-types/react.svg?react";
   import AstroIcon from "@/assets/icons/file-types/astro.svg?react";
   import AngularIcon from "@/assets/icons/file-types/angular.svg?react";
   import JsonIcon from "@/assets/icons/file-types/json.svg?react";
   import YamlIcon from "@/assets/icons/file-types/yaml.svg?react";
   import TomlIcon from "@/assets/icons/file-types/toml.svg?react";
   import XmlIcon from "@/assets/icons/file-types/xml.svg?react";
   import MarkdownIcon from "@/assets/icons/file-types/markdown.svg?react";
   import DocumentIcon from "@/assets/icons/file-types/document.svg?react";
   import CsvIcon from "@/assets/icons/file-types/csv.svg?react";
   import DatabaseIcon from "@/assets/icons/file-types/database.svg?react";
   import NodejsIcon from "@/assets/icons/file-types/nodejs.svg?react";
   import DockerIcon from "@/assets/icons/file-types/docker.svg?react";
   import GitIcon from "@/assets/icons/file-types/git.svg?react";
   import CertificateIcon from "@/assets/icons/file-types/certificate.svg?react";
   import FolderIcon from "@/assets/icons/file-types/folder.svg?react";
   import FolderOpenIcon from "@/assets/icons/file-types/folder-open.svg?react";
   
   type IconComponent = ComponentType<SVGProps<SVGSVGElement>>;
   
   // Map extensions to icons
   export const FILE_ICON_MAP: Record<string, IconComponent> = {
     // TypeScript
     ts: TypeScriptIcon,
     tsx: ReactIcon,
     mts: TypeScriptIcon,
     cts: TypeScriptIcon,
     
     // JavaScript
     js: JavaScriptIcon,
     jsx: ReactIcon,
     mjs: JavaScriptIcon,
     cjs: JavaScriptIcon,
     
     // Rust
     rs: RustIcon,
     
     // Python
     py: PythonIcon,
     pyw: PythonIcon,
     pyi: PythonIcon,
     
     // Go
     go: GoIcon,
     
     // Java
     java: JavaIcon,
     jar: JavaIcon,
     
     // C#
     cs: CSharpIcon,
     csx: CSharpIcon,
     
     // C/C++
     cpp: CppIcon,
     cxx: CppIcon,
     cc: CppIcon,
     c: CIcon,
     h: CIcon,
     hpp: CppIcon,
     
     // Ruby
     rb: RubyIcon,
     rake: RubyIcon,
     
     // PHP
     php: PhpIcon,
     
     // Swift
     swift: SwiftIcon,
     
     // Kotlin
     kt: KotlinIcon,
     kts: KotlinIcon,
     
     // Lua
     lua: LuaIcon,
     
     // Shell
     sh: ConsoleIcon,
     bash: ConsoleIcon,
     zsh: ConsoleIcon,
     fish: ConsoleIcon,
     ps1: ConsoleIcon,
     
     // Web
     html: HtmlIcon,
     htm: HtmlIcon,
     css: CssIcon,
     scss: ScssIcon,
     sass: ScssIcon,
     less: CssIcon,
     vue: VueIcon,
     svelte: SvelteIcon,
     astro: AstroIcon,
     
     // Data/Config
     json: JsonIcon,
     jsonc: JsonIcon,
     json5: JsonIcon,
     yaml: YamlIcon,
     yml: YamlIcon,
     toml: TomlIcon,
     xml: XmlIcon,
     svg: XmlIcon,
     
     // Markdown/Text
     md: MarkdownIcon,
     mdx: MarkdownIcon,
     txt: DocumentIcon,
     text: DocumentIcon,
     
     // Data
     csv: CsvIcon,
     tsv: CsvIcon,
     sql: DatabaseIcon,
     
     // Config
     lock: JsonIcon,
     env: DocumentIcon,
   };
   
   // Special filename mappings (exact match, case-insensitive)
   export const FILENAME_ICON_MAP: Record<string, IconComponent> = {
     "package.json": NodejsIcon,
     "package-lock.json": NodejsIcon,
     "yarn.lock": NodejsIcon,
     "pnpm-lock.yaml": NodejsIcon,
     "bun.lockb": NodejsIcon,
     "cargo.toml": RustIcon,
     "cargo.lock": RustIcon,
     "dockerfile": DockerIcon,
     "docker-compose.yml": DockerIcon,
     "docker-compose.yaml": DockerIcon,
     "compose.yml": DockerIcon,
     "compose.yaml": DockerIcon,
     ".gitignore": GitIcon,
     ".gitattributes": GitIcon,
     ".gitmodules": GitIcon,
     "license": CertificateIcon,
     "license.md": CertificateIcon,
     "license.txt": CertificateIcon,
     "readme.md": MarkdownIcon,
     "readme": MarkdownIcon,
     "tsconfig.json": TypeScriptIcon,
     "jsconfig.json": JavaScriptIcon,
     ".eslintrc": JsonIcon,
     ".eslintrc.json": JsonIcon,
     ".prettierrc": JsonIcon,
     "vite.config.ts": TypeScriptIcon,
     "vite.config.js": JavaScriptIcon,
     "angular.json": AngularIcon,
   };
   
   export function getFileIcon(filePath: string): IconComponent {
     const filename = filePath.split("/").pop() || filePath;
     const lowerFilename = filename.toLowerCase();
     
     // Check exact filename matches first (case-insensitive)
     for (const [key, icon] of Object.entries(FILENAME_ICON_MAP)) {
       if (key.toLowerCase() === lowerFilename) {
         return icon;
       }
     }
     
     // Get extension
     const ext = filename.includes(".") 
       ? filename.split(".").pop()?.toLowerCase() 
       : null;
     
     if (ext && FILE_ICON_MAP[ext]) {
       return FILE_ICON_MAP[ext];
     }
     
     return DocumentIcon;
   }
   
   export function getFolderIcon(isOpen: boolean): IconComponent {
     return isOpen ? FolderOpenIcon : FolderIcon;
   }
   
   export { DocumentIcon as DefaultFileIcon, FolderIcon, FolderOpenIcon };
   ```
  </action>
  <verify>
    - All SVG files exist in src/assets/icons/file-types/
    - `npm run build` succeeds (imports work)
    - TypeScript compiles without errors on file-icons.ts
  </verify>
  <done>Curated icons downloaded, extension mapping complete with getFileIcon utility</done>
</task>

<task type="auto">
  <name>Task 3: Create FileTypeIcon component</name>
  <files>
    - src/components/icons/FileTypeIcon.tsx
  </files>
  <action>
1. Create directory: `src/components/icons/`

2. Create src/components/icons/FileTypeIcon.tsx:
   ```typescript
   import { getFileIcon, getFolderIcon } from "@/lib/file-icons";
   import { cn } from "@/lib/utils";
   
   interface FileTypeIconProps {
     /** File path or filename to determine icon */
     path: string;
     /** Whether this is a directory */
     isDirectory?: boolean;
     /** Whether directory is expanded (only for directories) */
     isOpen?: boolean;
     /** Additional CSS classes */
     className?: string;
   }
   
   export function FileTypeIcon({ 
     path, 
     isDirectory = false,
     isOpen = false,
     className 
   }: FileTypeIconProps) {
     const Icon = isDirectory 
       ? getFolderIcon(isOpen) 
       : getFileIcon(path);
     
     return (
       <Icon 
         className={cn("w-4 h-4 shrink-0", className)} 
         aria-hidden="true"
       />
     );
   }
   ```
  </action>
  <verify>
    - Component renders without errors
    - TypeScript shows no errors
    - `npm run build` succeeds
  </verify>
  <done>FileTypeIcon component created and ready for integration</done>
</task>

</tasks>

<verification>
1. Build check: `npm run build` completes successfully
2. Type check: `npx tsc --noEmit` shows no errors
3. Manual verification: Icons render correctly when imported in a test component
</verification>

<success_criteria>
- vite-plugin-svgr installed and configured
- ~40 Catppuccin Mocha SVG icons downloaded to src/assets/icons/file-types/
- getFileIcon() returns correct icon for .ts, .tsx, .rs, .md, .json, .py, .go files
- getFileIcon() returns default icon for unknown extensions
- getFolderIcon() returns folder/folder-open icons
- FileTypeIcon component renders icons with proper sizing (w-4 h-4)
- Build succeeds with no TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/06.1-catppuccin-mocha-file-icons/06.1-01-SUMMARY.md`
</output>
