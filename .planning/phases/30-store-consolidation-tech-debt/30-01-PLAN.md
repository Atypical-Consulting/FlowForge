---
phase: 30-store-consolidation-tech-debt
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src-tauri/src/lib.rs
  - src/components/animations/AnimatedList.tsx
  - src/components/animations/FadeIn.tsx
  - src/components/animations/index.ts
  - src/components/layout/CollapsibleSidebar.tsx
  - src/components/layout/index.ts
  - src/stores/blades.ts
  - src/stores/blades.test.ts
  - public/debug/viewer3d-test.html
  - src/test-utils/mocks/tauri-commands.ts
autonomous: true

must_haves:
  truths:
    - "Orphaned v1.0 code (greet, CollapsibleSidebar, AnimatedList, FadeIn) does not exist in the codebase"
    - "Debug page viewer3d-test.html is not present in public/ directory"
    - "Deprecated useBladeStore and its test file are removed"
    - "Barrel exports no longer reference removed components"
    - "Application compiles and all existing tests pass after removals"
  artifacts:
    - path: "src-tauri/src/lib.rs"
      provides: "Rust entrypoint without greet command"
      contains: "no greet function"
    - path: "src/components/animations/index.ts"
      provides: "Empty or removed barrel export"
    - path: "src/components/layout/index.ts"
      provides: "Barrel without CollapsibleSidebar"
  key_links:
    - from: "src-tauri/src/lib.rs"
      to: "collect_commands!"
      via: "greet removed from command registration"
      pattern: "no greet in collect_commands"
---

<objective>
Remove all orphaned v1.0 code and the debug page from the codebase.

Purpose: Eliminate dead code from the production bundle (ARCH-10, ARCH-11) as zero-risk first step before any behavioral changes. This reduces noise for subsequent store consolidation work.
Output: Leaner codebase with no orphaned Rust commands, no unused animation/layout components, no debug HTML, and no deprecated blade store.
</objective>

<execution_context>
@/Users/phmatray/.claude/get-shit-done/workflows/execute-plan.md
@/Users/phmatray/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/30-store-consolidation-tech-debt/30-RESEARCH-IMPLEMENTATION.md
@src-tauri/src/lib.rs
@src/components/animations/AnimatedList.tsx
@src/components/animations/FadeIn.tsx
@src/components/animations/index.ts
@src/components/layout/CollapsibleSidebar.tsx
@src/components/layout/index.ts
@src/stores/blades.ts
@src/stores/blades.test.ts
@public/debug/viewer3d-test.html
@src/test-utils/mocks/tauri-commands.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove orphaned Rust greet command and TS animation/layout dead code</name>
  <files>
    src-tauri/src/lib.rs
    src/components/animations/AnimatedList.tsx
    src/components/animations/FadeIn.tsx
    src/components/animations/index.ts
    src/components/layout/CollapsibleSidebar.tsx
    src/components/layout/index.ts
    src/test-utils/mocks/tauri-commands.ts
  </files>
  <action>
    1. In `src-tauri/src/lib.rs`:
       - Delete the `greet` function (lines 48-52: the `#[tauri::command]` `#[specta::specta]` `async fn greet(name: String) -> String` block)
       - Remove `greet,` from the `collect_commands!` macro invocation (around line 57)

    2. Delete these files entirely:
       - `src/components/animations/AnimatedList.tsx` (orphaned, zero imports)
       - `src/components/animations/FadeIn.tsx` (orphaned, zero imports)
       - `src/components/layout/CollapsibleSidebar.tsx` (orphaned, zero imports)

    3. Update barrel exports:
       - `src/components/animations/index.ts`: Remove both export lines (AnimatedList, AnimatedListItem, FadeIn). If no other exports remain, delete the file.
       - `src/components/layout/index.ts`: Remove the `CollapsibleSidebar` export line. Keep the ResizablePanelLayout and SplitPaneLayout exports.

    4. In `src/test-utils/mocks/tauri-commands.ts`:
       - Remove the `greet` mock entry (around line 236). Do NOT remove `getMergeStatus` -- it is a valid command used by the merge flow.

    5. Check if `src/lib/animations.ts` exports (`fadeIn`, `fadeInUp`, `fadeInScale`, `staggerContainer`, `staggerItem`) are still imported elsewhere. If they are only used by AnimatedList/FadeIn, remove that file too. If imported by other components, leave it.
  </action>
  <verify>
    - `grep -r "AnimatedList\|FadeIn\|CollapsibleSidebar" src/ --include="*.ts" --include="*.tsx"` returns no results
    - `grep "greet" src-tauri/src/lib.rs` returns no results
    - `cd src-tauri && cargo check` compiles successfully
    - `npm run type-check` passes (or `npx tsc --noEmit`)
  </verify>
  <done>The greet Rust command, AnimatedList, FadeIn, and CollapsibleSidebar components are fully removed from the codebase. No broken imports or barrel references remain.</done>
</task>

<task type="auto">
  <name>Task 2: Remove debug page, deprecated blade store, and verify clean build</name>
  <files>
    public/debug/viewer3d-test.html
    src/stores/blades.ts
    src/stores/blades.test.ts
  </files>
  <action>
    1. Delete `public/debug/viewer3d-test.html`. If `public/debug/` is now empty, delete the entire `public/debug/` directory.

    2. Delete `src/stores/blades.ts` (the deprecated `useBladeStore` -- fully replaced by XState navigation machine).

    3. Delete `src/stores/blades.test.ts` (tests for the deprecated store).

    4. Verify no remaining imports reference `blades.ts` (NOT `bladeTypes.ts` -- that file must stay):
       - Search for `from.*stores/blades` but exclude matches for `bladeTypes`
       - If any consumer still imports from `stores/blades`, update it to use the XState navigation hooks (`useBladeNavigation` from `src/hooks/useBladeNavigation.ts`)

    5. Keep `src/stores/bladeTypes.ts` untouched -- it defines `BladeType`, `BladePropsMap`, `TypedBlade` which are used throughout the application.

    6. Run the full test suite to verify nothing breaks: `npm test`

    7. Run `npm run build` to verify the production build succeeds and `viewer3d-test.html` no longer appears in the output.
  </action>
  <verify>
    - `ls public/debug/` shows directory does not exist or is empty
    - `ls src/stores/blades.ts` shows file does not exist
    - `ls src/stores/blades.test.ts` shows file does not exist
    - `ls src/stores/bladeTypes.ts` shows file still exists
    - `npm test` passes all tests
    - `npm run build` succeeds
  </verify>
  <done>Debug page is excluded from production bundle. Deprecated useBladeStore is removed. bladeTypes.ts with type definitions preserved. All tests pass. Build succeeds.</done>
</task>

</tasks>

<verification>
1. `grep -r "AnimatedList\|FadeIn\|CollapsibleSidebar\|greet" src/ src-tauri/src/lib.rs --include="*.ts" --include="*.tsx" --include="*.rs"` -- returns zero matches
2. `ls public/debug/` -- directory does not exist or is empty
3. `ls src/stores/blades.ts src/stores/blades.test.ts 2>&1` -- both files not found
4. `ls src/stores/bladeTypes.ts` -- file exists (preserved)
5. `npm test` -- all tests pass
6. `npm run build` -- production build succeeds
</verification>

<success_criteria>
- Zero orphaned v1.0 code remains in the codebase (ARCH-10)
- Debug page is removed from public/ (ARCH-11)
- All existing tests pass without modification (except deleting blades.test.ts)
- Production build succeeds with reduced bundle size
</success_criteria>

<output>
After completion, create `.planning/phases/30-store-consolidation-tech-debt/30-01-SUMMARY.md`
</output>
