# v1.1.0 Research Summary

**Milestone:** v1.1.0 Usability
**Synthesized:** 2026-02-05
**Research Files:** UNGIT-TOPOLOGY.md, UX-UI-IMPROVEMENTS.md (ideas), v1.0 foundational research

---

## Executive Summary

v1.1.0 focuses on UX improvements and Ungit-style topology visualization. Research confirms:

1. **Topology rework is feasible** — Keep React Flow, consider elkjs for layout algorithm
2. **Inline commit details** — Ungit's key differentiator that FlowForge should adopt
3. **Quick wins are low-risk** — Toast, empty states, loading spinners use existing infrastructure
4. **Clone and Gitflow init** — Straightforward extensions of existing git2-rs patterns

---

## Key Findings by Feature

### 1. Ungit-Style Topology

**Source:** UNGIT-TOPOLOGY.md

| Finding | Implication |
|---------|-------------|
| Ungit uses vertical layout with spine | FlowForge can keep Gitflow lanes but add spine concept |
| Inline commit details below node | Use center panel for commit details on selection |
| Hash-based deterministic colors | Keep FlowForge's semantic Gitflow colors instead |
| 25 commits per page, lazy load | Already implemented in FlowForge |

**Recommendations:**
- Replace dagre with elkjs for better horizontal layered layout
- Show commit details in center panel when node selected
- Add hover preview before full selection
- Keep semantic Gitflow lane colors

### 2. Repository/Branch Switcher

**Source:** UX-UI-IMPROVEMENTS.md, competitive analysis

**Best practices from GitHub Desktop/GitKraken:**
- Top bar placement with current repo + branch visible
- Dropdown with recent branches and search
- Handle uncommitted changes with explicit dialog (Leave/Bring/Stash)

### 3. Settings Organization

**Pattern:** Dedicated settings window with tabbed navigation (not modal)

**Categories needed:**
- General (theme, default branch names)
- Gitflow (branch prefixes, merge behavior)
- Commits (conventional commit defaults)
- Graph (layout direction, commit limit)

### 4. Clone Repository

**Source:** Architecture research, git2-rs docs

**Implementation approach:**
- Reuse existing `create_credentials_callback()` from remote.rs
- Use `git2::build::RepoBuilder` with progress callbacks
- Show phases: Counting → Receiving → Resolving → Checkout

### 5. Toast Notifications

**Source:** UX-UI-IMPROVEMENTS.md

**Pattern:**
- Bottom-right positioning
- 5-8 seconds auto-dismiss for info/success
- No auto-dismiss for errors
- Enhance existing Framer Motion Toast component with Zustand queue

### 6. Empty States

**Pattern from GitHub Primer/GitLab Pajamas:**
- Illustration (100-144px)
- Title (5 words max, active verb)
- Description
- CTA button

**Empty states needed:**
- No changes to stage
- No stashes
- No tags
- No worktrees
- New repository (no commits)

### 7. Amend Commit

**Pattern:** Checkbox in commit panel that pre-fills previous message
- Load both subject and body
- Force push warning if commit was pushed
- Works for both regular and conventional commits

### 8. Gitflow Initialization

**Pattern:** Button-triggered dialog when `!is_gitflow_ready`
- Configure main branch name (default: main)
- Configure develop branch name (default: develop)
- Creates develop from main if doesn't exist
- Checkout develop after init

### 9. History Diff Viewing

**Implementation:**
- Add `get_commit_file_diff` backend command
- Use git2's `revparse_single("commit:filepath")` pattern
- Reuse existing Monaco DiffViewer component

---

## Technical Decisions

### Layout Library

| Option | Verdict | Reason |
|--------|---------|--------|
| Keep dagre | NO | Poor horizontal layout, hard to customize lanes |
| Switch to elkjs | YES | Better layered algorithm, React Flow integration exists |
| Switch to d3-dag | NO | Less React Flow support |

### Toast Library

| Option | Verdict | Reason |
|--------|---------|--------|
| Add Sonner | NO | Already have Framer Motion Toast |
| Enhance existing | YES | Just need Zustand queue store |

### Settings Persistence

| Option | Verdict | Reason |
|--------|---------|--------|
| tauri-plugin-store | YES | Already installed and working |

---

## Build Order Recommendation

Based on dependencies and risk:

```
Phase 11: Foundation (Toast + Settings)
├── Toast notification system (enables feedback for all operations)
├── Settings window + persistence
└── Left panel readability fixes

Phase 12: Workflows (Clone + Gitflow Init)
├── Clone repository command + UI
├── Gitflow initialization
└── Amend commit message loading

Phase 13: Polish (Quick Wins)
├── Empty state illustrations
├── Keyboard shortcut tooltips
├── Button loading spinners
├── Panel header frosted glass
├── Dirty state pulse animation
└── Conventional commits default off

Phase 14: Topology Rework
├── elkjs integration
├── Gitflow-aware lane layout
├── Commit selection + center panel details
├── History diff viewing
└── Auto-refresh on commits (tech debt fix)

Phase 15: Navigation
├── Repository/branch switcher in top bar
└── Conventional commits panel layout fix
```

**Rationale:**
- Toast first — provides feedback for all other features
- Settings second — required for Gitflow config, enables other settings
- Clone/Gitflow grouped — both are git operations
- Topology last — highest risk, defer to avoid blocking other features

---

## Risk Assessment

| Feature | Risk | Mitigation |
|---------|------|------------|
| Topology rework | MEDIUM | Keep dagre as fallback via feature flag |
| Clone | LOW | Follows existing remote operation patterns |
| Toast | LOW | Enhance existing component |
| Settings | LOW | Pattern established in codebase |
| History diff | LOW | Extends existing infrastructure |
| Gitflow init | LOW | Uses existing branch creation APIs |

---

## Pitfalls to Watch

From v1.0 PITFALLS.md that apply to v1.1.0:

1. **Large repo performance** — Topology rework must maintain <100ms render
2. **Layout jumping** — elkjs layout should be stable, not jump on updates
3. **Cross-platform testing** — Clone credentials behave differently per OS
4. **Settings migration** — Ensure v1.0 settings load correctly after upgrade

---

## Open Questions

1. **Topology direction:** Keep vertical (current) or switch to horizontal (Ungit-style)?
   - Recommendation: Keep vertical, it matches Gitflow lane visualization better

2. **Commit details placement:** Inline below node or in center panel?
   - Recommendation: Center panel — more space, reuses existing diff viewer

3. **Clone authentication:** System credential storage vs in-app?
   - Recommendation: System integration (already have credential callback)

---

## Files for Roadmapper

| File | Purpose |
|------|---------|
| .planning/research/UNGIT-TOPOLOGY.md | Topology implementation patterns |
| .planning/research/v1.1.0-SUMMARY.md | This synthesis |
| .planning/ideas/UX-UI-IMPROVEMENTS.md | Quick wins and polish features |
| .planning/research/ARCHITECTURE.md | Existing architecture (v1.0) |
| .planning/research/PITFALLS.md | Known pitfalls (v1.0) |
